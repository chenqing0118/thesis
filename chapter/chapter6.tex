\chapter{总结与展望}
\section{项目总结}
在国际局势紧张的大背景下，突破技术封锁愈发关键，这两年在国家紧锣密鼓的推进下各行业纷纷涌现出惊喜突破。
在关系到万家百姓出行的航空领域，我们已经拿出C919这一成果，相信不久之后便能迎来国产飞机的第一批旅客。
而在飞行训练相关的全动飞行模拟机领域仍有许多空白，能够达到训练标准的视景系统便是其中之一。
本文中描述了自主研发的全动飞行模拟机视景系统中的数据交换部分的设计与实现过程，能够让视景系统接入未开放接口的仿真机是主要工作。
\par
在项目开始阶段，本文通过结合文档和网络流量分析的方法，明确了仿真机与外界的交流方式。
仿真机中的网络协议栈最高层为数据链路层，其发出或接收的数据帧仅被以太网协议封装。
为了让其与位于应用层的视景系统沟通，系统中引入了虚拟仿真机这一角色。其首先充当仿真机侧的网络协议栈，负责接收并解封仿真机的数据帧。
其次因为双方都有自己的数字表示方法和数据组织结构，它需要对双方的数据内容进行转换。最后仿真机也负责与视景系统中的图像生成器通过TCP消息交流，将仿真机的指令送达或接收反馈指令。
在此过程中，为了尽可能提高交流效率，采用了开启立即转发模式、使用ProtoBuffer数据交换协议、禁用Nagle算法等措施。
\par
系统实现完成后进行了初步的测试，在将已被验证的多种指令给到视景系统后，其均能产生正确的对应效果。
但使用多个图像生成器进行融合投影时，发现存在两侧图像撕裂的问题。经排查原因在于多个图像生成器的数据没能同步，由此引入网络帧缓冲机制解决该问题。
之后又发现飞机在低空较高速飞行时，图像交界处存在抖动现象，经排查发现问题是多个投影仪的刷新时间没能同步。最终采用对缓冲中的数据插值的方法在软件层面缓解了该问题。
\section{项目展望}
虽然该视景系统已经达成一定的效果，但显然距离终极目标仍有距离，需要在后续的工作中安排完成。
\begin{itemize}
    \item [（1）]
    在多种仿真机适配方面虽然在系统结构上留下了空间，但实际操作比较困难。因为难以与国外FFS厂商达成合作，只能依赖现有文档去做逆向工程探索仿真机的私有协议结构与内容，这会是极其繁琐的工作。
    期待能够与未来的国产FFS厂商通力合作，不再经历如此费力的工作。
    \item [（2）]
    从整个视景系统来看，距离达到D级模拟机的标准任重道远，作为新产品必将经过严格的审查，各类灯光、天气、突发事件的模拟必须准确到位。实现上百条的细节要求仍需要整个团队相当时间的通力合作。
    \item [（3）]
    此视景系统是基于腾讯自研游戏引擎搭建，这不仅迈出国产视景系统的一步，也是又一自研引擎成长的过程，当前综合渲染效果及稳定性肯定不及成熟的商业游戏引擎。随着该游戏引擎的逐步完善，整个视景系统的体验必然会越来越好。
    
\end{itemize}
