% !Mode:: "TeX:UTF-8"
%# -*- coding:utf-8 -*-

%% 南京大学学位论文的示例文档
%% 作者：njuhan: https://github.com/njuHan
%% 源模版repo: https://github.com/njuHan/njuthesis-nju-thesis-template

\documentclass[winfonts,master,oneside]{njuthesis}
%% 审阅模式很重要，命令是下方使用的/blind
%% njuthesis 文档类的可选参数有：
%%   winfonts, linuxfonts, macfonts, adobefonts winfonts 选项使得文档使用Windows 系统提供的字体；linuxfonts 选项使得文档使用Linux 系统提供的字体；macfonts 选项使得文档使用Mac 系统提供的字体；adobefonts 选项使得文档使用Adobe提供的OTF中文字体(需自行下载安转)
%%   phd/master/bachelor 选择博士/硕士/学士论文
%%   twoside 或 oneside 指定排版的文档为双面打印或单面打印格式（twoside会使得chapter 章节从奇数页开始，即纸张的正面开始，因此会出现一些空白的页面）
%%   nobackinfo 取消封二页导师签名信息。注意，按照南大的规定，是需要签名页的。

\usepackage{pdfpages}
\usepackage{listings}
% \usepackage{ctex}
\usepackage{tabularx}
\usepackage{float}
% \usepackage{subfigure}
\lstset{
    basicstyle          =   \ttfamily,          % 基本代码风格
    keywordstyle        =   \bfseries,          % 关键字风格
    commentstyle        =   \rmfamily\itshape,  % 注释的风格，斜体
    stringstyle         =   \ttfamily,  % 字符串风格
    flexiblecolumns,                % 别问为什么，加上这个
    %numbers             =   left,   % 行号的位置在左边
    showspaces          =   false,  % 是否显示空格，显示了有点乱，所以不现实了
    numberstyle         =   \zihao{-5}\ttfamily,    % 行号的样式，小五号，tt等宽字体
    showstringspaces    =   false,
    captionpos          =   t,      % 这段代码的名字所呈现的位置，t指的是top上面
    frame               =   lrtb,   % 显示边框
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% set up labelformat and labelsep for subfigure 详见： http://www.latexstudio.net/archives/8652.html
\captionsetup[subfigure]{labelformat=simple, labelsep=space}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置《国家图书馆封面》的内容，仅博士论文才需要填写

% 设置论文按照《中国图书资料分类法》的分类编号
%\classification{0175.2}
% 设置论文按照《国际十进分类法UDC》的分类编号
% 该编号可在下述网址查询：http://www.udcc.org/udcsummary/php/index.php?lang=chi
%\udc{004.72}
% 国家图书馆封面上的论文标题第一行，不可换行。此属性可选，默认值为通过\title设置的标题。
%\nlctitlea{论文标题第一行}
% 国家图书馆封面上的论文标题第二行，不可换行。此属性可选，默认值为空白。
%\nlctitleb{论文标题第二行}
% 国家图书馆封面上的论文标题第三行，不可换行。此属性可选，默认值为空白。
%\nlctitlec{}
% 导师的单位名称及地址
%\supervisorinfo{南京大学计算机科学与技术系~~南京市汉口路22号~~210093}
% 答辩委员会主席
%\chairman{张三丰~~教授}
% 第一位评阅人
%\reviewera{阳顶天~~教授}
% 第二位评阅人
%\reviewerb{张无忌~~副教授}
% 第三位评阅人
%\reviewerc{黄裳~~教授}
% 第四位评阅人
%\reviewerd{郭靖~~研究员}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置论文的中文封面

% 单行论文标题，不可换行
\title{}
\titlea{全动飞行模拟视景系统中}
\titleb{数据交换子系统的设计与实现}
% 如果论文标题过长，可以分两行，第一行用\titlea{}定义，第二行用\titleb{}定义，
% 使用以下3行：
%\title{} %用于覆盖单行标题内容为空
%\titlea{长标题第一行}  %第一行标题写这里
%\titleb{长标题第二行用于长标题换行} %第二行标题写这里
% 注意： \title 不能都注释，它用于控制标题选择双行还是单行。\title{}如果内容为空，则编译\titlea{},titleb{}双行标题，否则编译单行标题


% 论文作者姓名
\author{陈氢}
% 论文作者联系电话
\telphone{19821233104}
% 论文作者电子邮件地址
\email{cq0118@126.com}
% 论文作者学生证号
\studentnum{MF21320019}
% 论文作者入学年份（年级）
\grade{2021}
% 论文作者毕业年份（届）, 出版授权书的学位年度
\graduateyear{2023}
% 导师姓名职称
\supervisor{冯桂焕副教授}
% 导师的联系电话
\supervisortelphone{}
% 论文作者的学科与专业方向
\major{电子信息（软件工程领域）}
% 论文作者的研究方向
\researchfield{软件工程}
% 论文作者所在院系的中文名称
\department{软件学院}
% 论文作者所在学校或机构的名称。此属性可选，默认值为``南京大学''。
\institute{南京大学}
% 论文的提交日期，需设置年、月、日。
\submitdate{2023年 05 月 04 日}
% 论文的答辩日期，需设置年、月、日。
\defenddate{2023年 05 月 22 日}
% 论文的定稿日期，需设置年、月、日。
% 此属性可选，若注释\date{}，则默认值为最后一次编译时的日期，精确到日。
\date{2023年5月4日}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置论文的英文封面

% 论文的英文标题，不可换行
\englishtitle{Design and Implementation of Data Exchange Subsystem in Full Flight Simulator Visual System }
% 论文作者姓名的拼音
\englishauthor{Chen Qing}
% 导师姓名职称的英文
\englishsupervisor{Associate Professor Feng Guihuan}
% 论文作者学科与专业的英文名
\englishmajor{Software Engineering}
% 论文作者所在院系的英文名称
\englishdepartment{Software Institute}
% 论文作者所在学校或机构的英文名称。此属性可选，默认值为``Nanjing University''。
\englishinstitute{Nanjing University}
% 论文完成日期的英文形式，它将出现在英文封面下方。需设置年、月、日。日期格式使用美国的日期
% 格式，即``Month day, year''，其中``Month''为月份的英文名全称，首字母大写；``day''为
% 该月中日期的阿拉伯数字表示；``year''为年份的四位阿拉伯数字表示。
% 此属性可选，若注释掉\englishdate{}，则默认值为最后一次编译时的日期。
\englishdate{May 4, 2023}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置论文的中文摘要

% 设置中文摘要页面的论文标题及副标题的第一行。
% 此属性可选，其默认值为使用|\title|命令所设置的论文标题
\abstracttitlea{全动飞行模拟视景系统中数据交换子系统}
% 设置中文摘要页面的论文标题及副标题的第二行。
% 此属性可选，其默认值为空白
\abstracttitleb{的设计与实现}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置论文的英文摘要

% 设置英文摘要页面的论文标题及副标题的第一行。
% 此属性可选，其默认值为使用|\englishtitle|命令所设置的论文标题
\englishabstracttitlea{Design and Implementation of Data Exchange Subsystem}
% 设置英文摘要页面的论文标题及副标题的第二行。
% 此属性可选，其默认值为空白
\englishabstracttitleb{in Full Flight Simulator Visual System}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 盲审命令，空白字段设置请看 .cls文件 \newcommand*{\blind}
%% 此外，请按照盲审要求自行去掉个人简历、致谢等页面中的个人信息
%%**********************！！！非常重要的盲审命令，送审前必选！！！****************
% \blind
%%**********************！！！非常重要的盲审命令，送审前必选！！！****************

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\belowcaptionskip}{-0.8cm}
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% 制作国家图书馆封面（博士学位论文才需要）
%\makenlctitle
% 制作中文封面
\maketitle
% 制作英文封面
\makeenglishtitle

\includepdf{chapter/statement_one.pdf}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 开始前言部分
\frontmatter
\begin{abstract}
    {全动飞行模拟机是能够还原对应型号客机驾驶体验的飞行训练设备，是各型号客机必备的孪生产品。
     视景系统是负责提供视觉效果的部分，需要与仿真机进行指令数据的交换，由视景系统中的图像生成器依据指令内容渲染图像。
     我国民航领域市场广阔且C919客机已然落地，整套模拟机设备高度依赖进口的局面亟需打破。
    \par
    本项目基于进口仿真机开发自研视景系统，本文设计并实现了视景系统中负责与仿真机沟通的数据交换子系统。
    由于进口设备不对外开放接口，本文首先通过抓取数据帧的方式解析了仿真机关键指令的数据交换协议，并利用WinPcap绕过操作系统的网络协议栈，实现了处理仿真机数据帧的特殊网络协议栈。
    其次设计了二十余种便于图像生成器使用的自定义指令，并实现了与仿真机指令间的转换方法，屏蔽仿真机间的差异，形成以虚拟仿真机为中间桥梁，连接两侧仿真机与图像生成器的系统架构，为全面国产化做准备。
    最后设计了与图像生成器数据交换的数据包组织结构，实现了不同自定义指令的处理方法，使用ProtoBuffer协议提升数据交换效率，满足帧率需求。
    \par
    在初步测试中，数据交换子系统可以正确解析数据帧并转换已明确的仿真机指令，最终产生正确的视觉效果。然而也发现在连接多台图像生成器融合投影的情况下，图像的拼接部分有撕裂，抖动的现象。
    经过分析排查后，在图像生成器数据交换部分设计实现了网络帧缓存和插值机制，达成多图像生成器间数据同步与平滑，改善了投影效果。
    目前该视景系统可以在进口仿真机驱动下，以至少60Hz帧率实现飞行和基础灯光天气效果。今后需实现更多指令内容以达成中国民用航空总局的验收标准。
    }          
	\keywords{飞行模拟；视景系统；数据交换；数据同步}          
\end{abstract}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 论文的英文摘要
\begin{englishabstract}
	{Full flight simulator is a flight training equipment which can simulate the piloting experience of passenger airplanes.
    It is necessary that each type of passenger airplane has corresponding flight simulator.
    Visual system is the part responsible for providing visual effects and needs to exchange instructions with the imitator.
    Finally, The image generator in the visual system renders images according to the instructions.
    Because China has a broad civil aviation market and COMAC C919 has been developed, the situation that whole set of simulator equipment is highly dependent on imports needs to be broken.
    \par
    This project is aimed to design a self-developed visual system based on imported imitator.
    In this thesis, the data exchange subsystem of visual system, which is responsible for communicating with the imitator, was designed and implemented.
    Because imported imitator dose not provide interfaces, the thesis analyzes the data exchange protocol of the key instructions of the imitator by capturing data frames at first.
    A special network protocol stack for processing imitator data frames is implemented by using WinPcap to bypass the network protocol stack of the operating system.
    Tnen more than 20 kinds of customized instructions are designed, and conversion methods between customized instructions and simulator instructions are implemented.
    Preparing for thorough domestic imitator, it shields the discrepancies between the imitators and establish a system architecture that the virtual imitator serves as the bridge to connect the imitator and the image generator.
    At last, the thesis designes a data packet structure for data exchange with the image generator and implements the processing of different customized instructions. 
    ProtoBuffer protocol is used to improve the efficiency of data exchange to meet the frame rate requirements.
    \par
    In preliminary tests, the data exchange subsystem is able to correctly process and convert the verified imitator instructions， so image generator renders the right visual effect.
    However, it is also found that the splicing part of the image has screen tearing and jitter when multiple image generators are connected.
    To alleviate the problems, the network frame cache and interpolation mechanism are introduced in image generator data exchange part to realize data synchronization and smoothing in multiple image generators.
    At present, under the control of imported imitator, the visual system realizes the flight and basic illumination and weather effects at least 60 frame rate. 
    More instructions need to be implemented in the future to meet the acceptance standards of the Civil Aviation Administration of China.
    }
    % 英文关键词。关键词之间用英文半角逗号隔开，末尾无符号。
	\englishkeywords{Flight Simulation, Visual System, Data Exchange, Data Synchronism}
\end{englishabstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 论文的前言，应放在目录之前，中英文摘要之后，一般不需要
%
%\begin{preface}
%
%在过去的40年中，手写中文文本领域识别（HCTR）取得了很大的进展[1,2]。
%
%\vspace{1cm}
%\begin{flushright}
%饶安逸\\
%2018年5月15日于南大仙林
%\end{flushright}
%
%\end{preface}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 生成论文目录
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 生成插图清单。如无需插图清单则可注释掉下述语句。
\listoffigures

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 生成附表清单。如无需附表清单则可注释掉下述语句。
\listoftables

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 开始正文部分
\mainmatter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 学位论文的正文应以《绪论》作为第一章，本模板是按照自身功能模块组织的，并非论文中的章节安排

\input{chapter/chapter1.tex}

\input{chapter/chapter2.tex}

\input{chapter/chapter3.tex}

\input{chapter/chapter4.tex}

\input{chapter/chapter5.tex}

\input{chapter/chapter6.tex}

% \input{chapter/Reference.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% 参考文献。应放在\backmatter之前。
% 推荐使用BibTeX，若不使用BibTeX时注释掉下面一句。
%\nocite{*}
\bibliography{sample}
% 致谢，应放在结论之后
\input{chapter/acknowledgement.tex}

% 附录，必须放在参考文献后，backmatter前
% \appendix
% \chapter{附录代码}\label{app:1}
% \section{main函数}
% \begin{lstlisting}[language=C]
% int main()
% {
% 	return 0;
% }
% \end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 书籍附件
\backmatter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 作者简历与科研成果页，应放在backmatter之后
% \begin{resume}
% % 论文作者身份简介，一句话即可。
% \begin{authorinfo}
% \noindent 韦小宝，男，汉族，1985年11月出生，江苏省扬州人。
% \end{authorinfo}
% % 论文作者教育经历列表，按日期从近到远排列，不包括将要申请的学位。
% \begin{education}
% \item[2007年9月 --- 2010年6月] 南京大学计算机科学与技术系 \hfill 硕士
% \item[2003年9月 --- 2007年6月] 南京大学计算机科学与技术系 \hfill 本科
% \end{education}
% % 论文作者在攻读学位期间所发表的文章的列表，按发表日期从近到远排列。
% \begin{publications}
% \item Xiaobao Wei, Jinnan Chen, ``Voting-on-Grid Clustering for Secure
%   Localization in Wireless Sensor Networks,'' in \textsl{Proc. IEEE International
%     Conference on Communications (ICC) 2010}, May. 2010.
% \item Xiaobao Wei, Shiba Mao, Jinnan Chen, ``Protecting Source Location Privacy
%   in Wireless Sensor Networks with Data Aggregation,'' in \textsl{Proc. 6th
%     International Conference on Ubiquitous Intelligence and Computing (UIC)
%     2009}, Oct. 2009.
% \end{publications}
% % 论文作者在攻读学位期间参与的科研课题的列表，按照日期从近到远排列。
% \begin{projects}
% \item 国家自然科学基金面上项目``问题研究''
% （课题年限~2010年1月 --- 2012年12月），负责相关问题的研究。
% \end{projects}
% \end{resume}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 生成《学位论文出版授权书》页面，应放在最后一页
\makelicense

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
